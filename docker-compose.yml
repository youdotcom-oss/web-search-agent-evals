services:
  # Gemini + builtin search
  gemini-builtin:
    build:
      context: .
      dockerfile: docker/gemini.Dockerfile
    image: acp-evals-gemini:latest
    env_file: .env
    environment:
      - MCP_TOOL=builtin
      - AGENT=gemini
    volumes:
      - ./data:/eval/data:ro
      - ./agent-schemas:/eval/agent-schemas:ro
      - ./tools:/eval/tools:ro
      - ./scripts:/eval/scripts:ro
      - ./data/results:/eval/data/results:rw
    working_dir: /workspace
    command:
      - bunx
      - "@plaited/acp-harness"
      - capture
      - /eval/data/prompts/search-test.jsonl
      - --cwd
      - /workspace
      - -o
      - /eval/data/results/gemini/builtin.jsonl
      - --progress
      - --
      - bunx
      - "@plaited/acp-harness"
      - headless
      - --schema
      - /eval/agent-schemas/gemini.json

  # Gemini + You.com MCP
  gemini-you:
    build:
      context: .
      dockerfile: docker/gemini.Dockerfile
    image: acp-evals-gemini:latest
    env_file: .env
    environment:
      - MCP_TOOL=you
      - AGENT=gemini
    volumes:
      - ./data:/eval/data:ro
      - ./agent-schemas:/eval/agent-schemas:ro
      - ./tools:/eval/tools:ro
      - ./scripts:/eval/scripts:ro
      - ./data/results:/eval/data/results:rw
    working_dir: /workspace
    command:
      - bunx
      - "@plaited/acp-harness"
      - capture
      - /eval/data/prompts/search-test.jsonl
      - --cwd
      - /workspace
      - -o
      - /eval/data/results/gemini/you.jsonl
      - --progress
      - --
      - bunx
      - "@plaited/acp-harness"
      - headless
      - --schema
      - /eval/agent-schemas/gemini.json
