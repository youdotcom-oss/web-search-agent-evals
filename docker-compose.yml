services:
  # Gemini AI Agent
  # Run with: docker compose run --rm -e MCP_TOOL=builtin gemini
  #       or: docker compose run --rm -e MCP_TOOL=you gemini
  gemini:
    build:
      context: .
      dockerfile: docker/gemini.Dockerfile
    image: acp-evals-gemini:latest
    env_file: .env
    environment:
      - AGENT=gemini
      # MCP_TOOL will be injected by `docker compose run -e MCP_TOOL=...`
    volumes:
      - ./data:/eval/data:ro
      - ./agent-schemas:/eval/agent-schemas:ro
      - ./tools:/eval/tools:ro
      - ./scripts:/eval/scripts:ro
      - ./data/results:/eval/data/results:rw
    working_dir: /workspace

  # Claude Code Agent
  # Run with: docker compose run --rm -e MCP_TOOL=builtin claude-code
  #       or: docker compose run --rm -e MCP_TOOL=you claude-code
  claude-code:
    build:
      context: .
      dockerfile: docker/claude-code.Dockerfile
    image: acp-evals-claude-code:latest
    env_file: .env
    environment:
      - AGENT=claude-code
      # MCP_TOOL will be injected by `docker compose run -e MCP_TOOL=...`
    volumes:
      - ./data:/eval/data:ro
      - ./agent-schemas:/eval/agent-schemas:ro
      - ./tools:/eval/tools:ro
      - ./scripts:/eval/scripts:ro
      - ./data/results:/eval/data/results:rw
    working_dir: /workspace

  # Droid Agent
  # Run with: docker compose run --rm -e MCP_TOOL=builtin droid
  #       or: docker compose run --rm -e MCP_TOOL=you droid
  droid:
    build:
      context: .
      dockerfile: docker/droid.Dockerfile
    image: acp-evals-droid:latest
    env_file: .env
    environment:
      - AGENT=droid
      # MCP_TOOL will be injected by `docker compose run -e MCP_TOOL=...`
    deploy:
      resources:
        limits:
          memory: 4G
    volumes:
      - ./data:/eval/data:ro
      - ./agent-schemas:/eval/agent-schemas:ro
      - ./tools:/eval/tools:ro
      - ./scripts:/eval/scripts:ro
      - ./data/results:/eval/data/results:rw
    working_dir: /workspace

  # Codex Agent
  # Run with: docker compose run --rm -e MCP_TOOL=builtin codex
  #       or: docker compose run --rm -e MCP_TOOL=you codex
  codex:
    build:
      context: .
      dockerfile: docker/codex.Dockerfile
    image: acp-evals-codex:latest
    env_file: .env
    environment:
      - AGENT=codex
      # MCP_TOOL will be injected by `docker compose run -e MCP_TOOL=...`
    volumes:
      - ./data:/eval/data:ro
      - ./agent-schemas:/eval/agent-schemas:ro
      - ./tools:/eval/tools:ro
      - ./scripts:/eval/scripts:ro
      - ./data/results:/eval/data/results:rw
    working_dir: /workspace
